# 地铁隧道巡检应用鸿蒙版 (Metro Tunnel Inspection App - HarmonyOS Edition)

本项目是一个基于鸿蒙原生开发技术构建的地铁隧道巡检任务和缺陷管理平台。它旨在为巡检人员和管理人员提供一个在平板设备上高效、直观地进行数据录入、查询和管理的移动解决方案。

该应用是根据一个已有的 Web 端平台的核心功能进行鸿蒙原生化迁移的成果，充分利用了 ArkTS 语言的类型安全特性和 ArkUI 框架的声明式UI构建能力。

---

## ✨ 功能说明 (Features)

应用目前包含三大核心功能模块：

#### 1. 👤 用户认证 (User Authentication)
- **登录与权限验证**: 提供用户登录界面，与后端进行交互，实现安全的身份认证。
- **图形验证码**: 集成了图形验证码机制，提升登录安全性。
- **全局Token管理**: 通过全局服务 (`AuthService`) 对登录后获取的 `Token` 进行统一管理，并自动为所有需要授权的API请求添加 `Authorization` 请求头。

#### 2. 🐛 缺陷管理 (Defect Management)
- **列表展示与分页**: 以列表形式清晰展示所有缺陷数据，并支持后端分页加载。
- **多条件智能筛选**: 提供基于任务名称、缺陷类型、严重程度和当前状态的复合型筛选功能。
- **数据实时刷新**: 实现了在新增、修改数据后返回列表时，页面的数据能自动刷新，保证了数据的一致性。
- **缺陷详情与操作**: 支持查看任一缺陷的完整详细信息，并可对缺陷进行状态变更操作（如“标记为已整改”），操作结果会实时在当前页面反馈。
- **新增缺陷**: 提供独立的表单页面，用于创建新的缺陷记录，支持自动生成符合业务规则的缺陷ID。

#### 3. 📅 任务管理 (Task Management)
- **自定义日历视图**: 由于官方 `<Calendar>` 组件在目标API版本中的局限性，我们使用基础的 `<Grid>` 组件从零构建了一个功能完善且高度自定义的日历视图。
- **月度任务概览**: 日历能自动根据当前显示的月份，从后端加载任务数据，并在对应的日期上以带颜色的“任务标签”形式进行预览。
- **智能交互**:
    - 点击日期，下方会联动显示当天的详细任务列表。
    - 如果某一天只有一个任务，点击该日期将直接跳转到详情页，优化了操作路径。
- **任务操作**: 支持在详情页对任务进行删除等操作，返回日历页后数据会自动刷新。

---

## 🚀 安装部署指南 (Installation Guide)

#### 环境要求
- **IDE**: DevEco Studio 4.0 或更高版本。
- **SDK**: HarmonyOS SDK API Version 10 或更高版本。
- **后端服务**: 本项目仅为前端应用，您必须**保证配套的后端服务正在本地网络中运行**。

#### 安装步骤
1.  **克隆仓库**
    ```bash
    git clone [您的仓库地址]
    ```

2.  **打开项目**
    使用 DevEco Studio 打开克隆下来的项目文件夹。IDE 会自动同步和构建项目。

3.  **配置后端地址（关键步骤）**
    打开项目中的 `entry/src/main/ets/services/ApiService.ets` 文件，找到 `BASE_URL` 这个常量，并将其值修改为您正在运行的后端服务的**真实局域网IP地址和端口**。
    ```typescript
    // 示例
    const BASE_URL = '[http://192.168.1.10:8080](http://192.168.1.10:8080)'; 
    ```
    **注意**：此地址**不能**是 `localhost` 或 `127.0.0.1`。

4.  **构建项目**
    通常IDE会自动处理。如果需要，您可以在顶部菜单栏选择 **Build** -> **Rebuild Project** 来进行一次完整的重新构建。

#### 运行应用
1.  在 DevEco Studio 的右上角，选择一个目标设备（推荐使用 **Tablet (API 10+)** 模拟器）。
2.  点击绿色的“运行” (▶️) 按钮，应用将被编译并安装到您选择的模拟器上。

---

## 📖 使用说明 (Usage Instructions)

1.  **登录**
    - 应用启动后，将首先进入**登录页面**。
    - 输入您的账号、密码以及右侧图片中显示的图形验证码。
    - 点击“登录”按钮。登录成功后，应用将自动跳转到缺陷管理主页。

2.  **模块切换**
    - 在“缺陷管理”页面的右上角，有一个“任务列表”按钮，点击可跳转到任务日历页面。
    - 在“任务管理”页面的右上角，有一个“缺陷列表”按钮，点击可返回缺陷管理页面。

3.  **缺陷管理**
    - **筛选**: 在页面顶部的筛选栏中输入条件，点击“搜索”按钮。点击“重置”按钮可清空所有筛选条件并刷新列表。
    - **新增**: 点击右下角的“+ 新增缺陷”悬浮按钮，进入新增页面。填写完所有必填项后，点击“提交”按钮。
    - **查看/修改**: 点击列表中的任意一项，即可进入该缺陷的详情页。在详情页，如果缺陷状态不是“已整改”，则会出现“标记为已整改”按钮，点击即可更新状态，结果会立即在当前页面生效。

4.  **任务管理**
    - **浏览**: 在日历页面，点击顶部的 `<` 和 `>` 按钮可以切换上一个月和下一个月。
    - **查看**: 日历的日期单元格内会直接预览当天的任务。如果某天只有一个任务，直接点击该单元格即可跳转到详情页。如果任务较多，点击单元格后，会在日历下方出现当天的任务列表，再点击列表中的具体任务项进行跳转。
    - **删除**: 在任务详情页，可以找到“删除任务”按钮，点击并确认后即可删除该任务。返回日历页时，该任务将自动消失。
